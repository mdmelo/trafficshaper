<!DOCTYPE html>
<html>
<head>
    <title>Network Traffic Shaper</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f7f9fb; }
        .card { background: #fff; border-radius: 10px; box-shadow: 0 2px 10px #0001; margin: 30px auto; padding: 32px; max-width: 600px;}
        .card h1 { margin-top: 0; }
        label { display: block; margin: 10px 0 4px; }
        input, select { width: 100%; padding: 8px; margin-bottom: 12px; border-radius: 4px; border: 1px solid #ddd; }
        button { width: 100%; padding: 12px; background: #2196f3; color: #fff; border: none; border-radius: 6px; font-size: 1em; cursor: pointer; }
        button:hover { background: #1565c0; }
        .success { color: green; }
    </style>
    <script>
    function onInterfaceChange(selectObj) {
        window.location = '?interface=' + encodeURIComponent(selectObj.value);
    }
    </script>
</head>
<body>
    <div class="card">
        <h1>Network Traffic Shaper</h1>
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <ul>
            {% for category, message in messages %}
              <li class="{{ category }}">{{ message }}</li>
            {% endfor %}
            </ul>
          {% endif %}
        {% endwith %}
        <form method="post">
            <label>Select Interface:</label>
            <select name="interface" onchange="onInterfaceChange(this)">
                {% for iface in interfaces %}
                <option value="{{ iface }}" {% if iface == selected_interface %}selected{% endif %}>{{ iface }}</option>
                {% endfor %}
            </select>
            <label>Rate Limit (e.g., 1mbit):</label>
            <input type="text" name="rate_limit" value="{{ config['rate_limit'] }}">
            <label>Packet Loss (%):</label>
            <input type="number" name="packet_loss" value="{{ config['packet_loss'] }}" min="0" max="100" step="any">
            <label>Packet Duplication (%):</label>
            <input type="number" name="packet_duplication" value="{{ config['packet_duplication'] }}" min="0" max="100" step="any">
            <label>Protocol:</label>
            <select name="protocol">
                <option value="All" {% if config['protocol'] == 'All' %}selected{% endif %}>All</option>
                <option value="TCP" {% if config['protocol'] == 'TCP' %}selected{% endif %}>TCP</option>
                <option value="UDP" {% if config['protocol'] == 'UDP' %}selected{% endif %}>UDP</option>
            </select>
            <button type="submit">Apply Traffic Shaping</button>
        </form>
    </div>
</body>
</html>
